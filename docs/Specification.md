# PRBS15 Generator Documentation

## Overview

Pseudo-Random Binary Sequence (PRBS) generators are essential components in digital communication systems for testing, synchronization, and data scrambling applications. A PRBS generator produces a deterministic sequence that appears random but can be reproduced using a known seed and polynomial. The PRBS15 generator described in this specification produces 8-bit parallel outputs that interface with a serializer module, which converts the parallel data into a serial stream. The serializer operates at four times the clock frequency of the PRBS15 generator and samples data on both rising and falling edges of its clock, effectively achieving an 8:1 serialization ratio.

## Functionality

### PRBS15 Generator Algorithm

The PRBS15 generator implements a Linear Feedback Shift Register (LFSR) using the polynomial **x^15 + x^14 + 1**. This polynomial defines a 15-bit LFSR that generates a pseudo-random sequence with a period of 32,767 bits (2^15 - 1).

In order to understand the PRBS15 generator operation, the following parameters are needed:
1. Clock signal (clock)
2. Reset signal (reset_n)
3. Enable signal (enable)
4. Seed value (prbs_seed[14:0]) - 15-bit seed for PRBS15
5. Load seed (load)
6. Parallel output (prbs_out[7:0])

The PRBS15 generator produces an 8-bit parallel output on each clock cycle of the PRBS clock domain. The generator implements a 15-bit LFSR (bits [14:0]) with feedback computed as bit[14] XOR bit[13]. First the seed will be loaded by toggling the load from LOW to HIGH, then, when enabled, the generator continuously produces pseudo-random sequences starting from the initial seed value. The MSB of the LFSR (bit[14]) is used to generate the output bits. MSB of the PRBS is mapped to the MSB of the output.

**PRBS15 Polynomial:** x^15 + x^14 + 1

**LFSR Operation:**
- The LFSR uses bits [14:0] (15 bits total)
- Feedback is computed as: feedback = bit[14] XOR bit[13]
- On each shift: lfsr[14:0] = {lfsr[13:0], feedback}
- Output bits are generated by reading bit[14] of the LFSR state 8 times, advancing the LFSR after each read

**Example:** For PRBS15 with seed 0x3C, the first output will be generated from the loaded seed value. The LFSR state is 15'h003C, and 8 bits are extracted from bit[14] as the LFSR advances.

### Interface with Serializer

The PRBS15 generator provides 8-bit parallel outputs that are consumed by a serializer module. The serializer operates with the following characteristics:

- **Clock Frequency Ratio**: The serializer clock frequency is 4 times the PRBS15 generator clock frequency
- **Sampling Method**: The serializer samples data on both rising and falling edges of its clock
- **Serialization Ratio**: The serializer sends 8 bits serially for each 8-bit parallel input from the PRBS15 generator
- **Data Transfer**: Every PRBS15 clock cycle, 8 new bits are generated and made available to the serializer. The serializer processes these 8 bits and outputs 8 bits serially over 4 of its clock cycles (2 bits per clock cycle, one on each edge)

### Clock Domain Relationship

The relationship between the PRBS15 generator clock and serializer clock can be expressed as:

f<sub>serializer</sub> = 4 &times; f<sub>prbs</sub>

Where:
- f<sub>serializer</sub> : Serializer clock frequency
- f<sub>prbs</sub> : PRBS15 generator clock frequency

Since the serializer samples on both edges, it effectively operates at 2 &times; f<sub>serializer</sub> = 8 &times; f<sub>prbs</sub>, allowing it to output 8 serial bits per PRBS15 clock cycle from the 8-bit parallel input.

### FSM-Controlled Process

When reset_n is LOW, the PRBS15 generator should be initialized to a known state. The internal state machine orchestrates the PRBS15 generation process, managing seed initialization, LFSR operation, and output generation when reset_n is HIGH and enable is asserted.

### Reset and Initialization

- When reset_n is LOW, the PRBS15 generator should initialize its internal state, reset is active low asynchronous
- The seed value (prbs_seed[14:0]) should be loaded into the LFSR when load transitions from LOW to HIGH
- First prbs_seed is given, wait for some time and then load signal is toggled from LOW to HIGH and only after seed is loaded, enable should be given.
- When enable is LOW, PRBS15 generation should pause, maintaining the current state
- When enable is HIGH, PRBS15 generation should proceed normally
- If the loaded seed is 0, the output should remain 0 (zero seed produces zero output)

### Output Generation

- The PRBS15 generator should produce a new 8-bit output (prbs_out[7:0]) on each positive edge of the PRBS clock when enable is HIGH
- The output should remain stable between clock edges to allow proper sampling by the serializer
- The 8-bit output represents the parallel data that will be serialized by the downstream serializer module
- The The first output after enable is made high is MSB 8 bits of the seed, advancing the LFSR state after each read

## Working Example

### PRBS15 Generation and Serialization

Let us consider the following scenario:

**Parameters:**
- PRBS15 generator clock period: T<sub>prbs</sub> = 10 ns (f<sub>prbs</sub> = 100 MHz)
- Serializer clock period: T<sub>serializer</sub> = 2.5 ns (f<sub>serializer</sub> = 400 MHz)
- PRBS15 seed: 15'h003C (15-bit seed)
- Enable: HIGH



**Key Points:**
- Each 8-bit PRBS15 output is processed by the serializer over 4 serializer clock cycles
- The serializer outputs 2 bits per clock cycle (one on rising edge, one on falling edge)
- Total of 8 bits are sent serially for each 8-bit parallel input from the PRBS15 generator
- The PRBS15 generator must maintain stable outputs for the entire duration that the serializer is sampling (one PRBS clock period)
- All 8 bits from the 8-bit parallel input are sent serially by the serializer
- The PRBS15 sequence has a period of 32,767 bits (2^15 - 1) before repeating